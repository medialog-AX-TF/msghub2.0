# 메시지허브 2.0 구축 요구사항

## 1. 프로젝트 개요

메시지허브 2.0은 기존 메시지허브 시스템을 개선하여 AI 어시스턴트를 활용한 자동화 기능을 추가하는 프로젝트입니다. 사용자가 문자 발송 및 템플릿 관리를 더 효율적으로 수행할 수 있도록 AI 기반 도구를 통합하여 웹사이트 내 특정 메뉴 이동 및 기능 자동 실행을 지원합니다.

### 1.1 시스템 아키텍처 개요

메시지허브 2.0은 다음과 같은 구조로 작동합니다:

```
웹사이트 <-> AI 어시스턴트 <-> LLM <-> 웹사이트 자동화
```

1. **사용자 입력**: 사용자가 웹사이트의 AI 어시스턴트 사이드바에 자연어로 요청 입력
2. **AI 어시스턴트 처리**:
   - System Prompt: 어시스턴트의 역할과 기능 정의
   - Tools 정의: 웹사이트 자동화를 위한 도구 목록 및 스키마 제공
   - User Prompt: 사용자 요청을 LLM에 전달
3. **LLM 의도 분석**:
   - 사용자 의도 파악
   - 적절한 도구(tool) 선정
   - 필요한 파라미터 추출
4. **도구 실행**:
   - 선택된 도구에 파라미터 전달
   - 웹사이트의 특정 기능 실행 (메뉴 이동, 텍스트 입력 등)
5. **결과 반환**: 실행 결과를 사용자에게 표시

## 2. 핵심 요구사항

### 2.1 AI 어시스턴트 통합

- **우측 사이드바 AI 어시스턴트**
  - 웹사이트 우측에 접을 수 있는 AI 어시스턴트 사이드바 구현
  - 사용자와 AI 간의 대화형 인터페이스 제공
  - 문자 발송 및 템플릿 관리에 관한 도움말 제공
  - 대화 이력 저장 및 관리 기능

- **System Prompt 구성**
  - 어시스턴트의 역할 및 목적 명확히 정의
  - 메시지허브 웹사이트의 구조 및 기능에 대한 상세 정보 포함
  - 도구 사용 지침 및 제약사항 명시
  - 응답 형식 및 스타일 가이드라인 제공
  - 사용자 의도 파악을 위한 컨텍스트 정보 포함

- **User Prompt 처리**
  - 사용자 입력을 LLM에 전달하는 형식 정의
  - 이전 대화 컨텍스트 유지 및 참조 기능
  - 사용자 요청의 명확화를 위한 추가 질문 생성 로직

### 2.2 자동화 기능 요구사항

- **메뉴 이동 자동화**
  - 프롬프트를 통해 "발송 > 통합발송", "RCS 캠페인", "템플릿" 등 특정 메뉴로 자동 이동
  - 메뉴 이동 시 필요한 중간 단계 자동 처리
  - 이동 경로 히스토리 저장 및 표시
  - 메뉴 구조 변경에 대응할 수 있는 유연한 이동 로직

- **기능 실행 자동화**
  - 템플릿 검색 및 선택 자동화
  - 문자 발송 프로세스 자동화 (수신자 정보 입력, 치환 태그 값 설정 등)
  - 발송 상태 확인 및 결과 보고서 생성 자동화
  - 템플릿 생성 및 관리 자동화
  - 작업 실행 중 오류 발생 시 복구 및 대안 제시 기능

- **데이터 처리 자동화**
  - 엑셀/CSV 파일에서 수신자 정보 자동 추출 및 적용
  - 발송 결과 데이터 자동 분석 및 요약
  - 반복적인 데이터 입력 작업 자동화
  - 데이터 형식 검증 및 오류 수정 기능

### 2.3 LLM 및 도구 활용 요구사항

- **LLM 모델 컨텍스트 정의 및 도구 활용**
  - LLM에게 전달되는 모델 컨텍스트를 명확히 정의하여 의도 파악 정확도 향상
  - 사용자 의도에 따라 적절한 도구(tool)를 자동으로 선택하고 실행하는 기능
  - 웹사이트 내 특정 작업(검색, 선택, 입력, 클릭 등)을 LLM이 이해하고 실행할 수 있는 도구 세트 구현
  - 도구 실행 결과를 LLM에 피드백하여 후속 작업 결정에 활용
  - 도구 실행 실패 시 대체 방안 제시 및 오류 복구 로직

- **웹 인터페이스 도구 유형 및 스키마**
  - 각 도구는 JSON 스키마 형식으로 정의되며, 필수 및 선택적 매개변수를 포함
  - 도구 호출 결과 형식 표준화
  - 다음과 같은 웹 인터페이스 도구 유형 구현:
    ```json
    {
      "navigate_to": {
        "description": "특정 메뉴 또는 URL로 이동",
        "parameters": {
          "menu_path": "메뉴 경로 (예: '발송 > 통합발송')",
          "url": "직접 이동할 URL (선택적)"
        }
      },
      "click_element": {
        "description": "버튼, 링크, 체크박스 등 요소 클릭",
        "parameters": {
          "element_id": "요소 ID",
          "element_text": "요소 텍스트 (ID가 없는 경우)",
          "element_type": "요소 유형 (버튼, 링크 등)"
        }
      },
      "input_text": {
        "description": "텍스트 필드에 내용 입력",
        "parameters": {
          "field_id": "필드 ID",
          "field_name": "필드 이름 (ID가 없는 경우)",
          "text": "입력할 텍스트"
        }
      },
      "select_option": {
        "description": "드롭다운 메뉴에서 옵션 선택",
        "parameters": {
          "select_id": "선택 요소 ID",
          "option_value": "선택할 옵션 값",
          "option_text": "선택할 옵션 텍스트 (값이 없는 경우)"
        }
      },
      "upload_file": {
        "description": "파일 업로드 기능 실행",
        "parameters": {
          "upload_id": "업로드 요소 ID",
          "file_path": "업로드할 파일 경로"
        }
      },
      "download_file": {
        "description": "파일 다운로드 기능 실행",
        "parameters": {
          "download_link": "다운로드 링크 또는 버튼 ID",
          "save_path": "저장할 경로 (선택적)"
        }
      },
      "extract_data": {
        "description": "웹 페이지에서 데이터 추출",
        "parameters": {
          "container_id": "데이터 컨테이너 ID",
          "data_type": "추출할 데이터 유형 (표, 목록 등)",
          "filter": "데이터 필터링 조건 (선택적)"
        }
      },
      "fill_form": {
        "description": "여러 필드가 있는 양식 자동 작성",
        "parameters": {
          "form_id": "양식 ID",
          "fields": "필드 이름과 값의 키-값 쌍"
        }
      },
      "submit_form": {
        "description": "작성된 양식 제출",
        "parameters": {
          "form_id": "양식 ID",
          "submit_button_id": "제출 버튼 ID (선택적)"
        }
      },
      "confirm_dialog": {
        "description": "확인/취소 대화상자 응답",
        "parameters": {
          "action": "응답 (confirm/cancel)",
          "dialog_text": "대화상자 텍스트 (선택적)"
        }
      }
    }
    ```

- **도구 호출 스키마 정의**
  - 각 도구별 입력 스키마 정의 (필수 매개변수, 선택적 매개변수)
  - 도구 호출 결과 처리 및 후속 작업 연계 방식 정의
  - 도구 호출 시 사용자 승인 프로세스 구현
  - 도구 호출 이력 기록 및 관리 기능
  - 도구 호출 제한 및 권한 관리 기능

- **AI 모델 연동**
  - 자연어 처리를 위한 고급 AI 모델 연동 (Claude 3.7 Sonnet 등)
  - 사용자 의도 파악 및 적절한 작업 실행
  - 사용자 피드백을 통한 지속적인 학습 및 개선
  - 모델 파라미터 최적화 (temperature, topP, maxTokens 등)
  - 모델 응답 캐싱 및 최적화 기능

## 3. 사용자 시나리오

### 시나리오 1: 템플릿 검색 및 발송

1. 사용자가 AI 어시스턴트에 "광고성 RCS 템플릿 찾아서 발송해줘"라고 프롬프트 입력
2. AI 어시스턴트가 사용자 의도를 분석하고 `navigate_to` 도구를 호출하여 템플릿 메뉴로 자동 이동
3. `input_text` 도구를 사용하여 검색창에 "광고성 RCS" 입력 후 `click_element`로 검색 버튼 클릭
4. `extract_data` 도구로 검색 결과를 추출하여 사용자에게 보여주고 선택 요청
5. 사용자가 템플릿 선택 후, `navigate_to` 도구를 사용하여 발송 페이지로 자동 이동
6. `fill_form` 도구를 사용하여 수신자 정보 입력 요청 및 입력 받은 정보로 발송 양식 자동 완성
7. `submit_form` 도구로 최종 확인 후 발송 실행

### 시나리오 2: 새 템플릿 생성

1. 사용자가 "새로운 정보성 문자 템플릿 만들어줘"라고 프롬프트 입력
2. AI 어시스턴트가 사용자 의도를 분석하고 `navigate_to` 도구를 호출하여 템플릿 생성 페이지로 자동 이동
3. 템플릿 유형, 내용 등 필요 정보 요청
4. `fill_form` 도구를 사용하여 사용자 입력에 따라 템플릿 양식 자동 완성
5. `extract_data` 도구로 미리보기 제공 및 수정 사항 반영
6. `submit_form` 도구로 최종 확인 후 템플릿 등록 실행

### 시나리오 3: 발송 결과 분석

1. 사용자가 "어제 발송한 메시지 결과 분석해줘"라고 프롬프트 입력
2. AI 어시스턴트가 사용자 의도를 분석하고 `navigate_to` 도구를 호출하여 조회 메뉴로 자동 이동
3. `fill_form` 도구를 사용하여 어제 날짜 기준으로 검색 조건 설정
4. `click_element` 도구로 검색 버튼 클릭
5. `extract_data` 도구를 사용하여 발송 결과 데이터 자동 수집
6. LLM이 수집된 데이터를 분석하여 성공/실패율, 열람률 등 주요 지표 요약 제공
7. 문제점 분석 및 개선 제안 제시

## 4. 기술적 요구사항

### 4.1 프론트엔드

- **웹 기술**
  - HTML5, CSS3, JavaScript(ES6+) 사용
  - 반응형 디자인으로 다양한 디바이스 지원
  - 모던 브라우저 호환성 보장
  - React 또는 Vue.js 프레임워크 활용

- **UI/UX**
  - 직관적인 AI 어시스턴트 인터페이스
  - 사용자 작업 진행 상황 시각화
  - 접근성 표준 준수
  - 도구 실행 과정 및 결과 표시 UI 구현

- **AI 어시스턴트 인터페이스**
  - 대화형 채팅 인터페이스
  - 메시지 타이핑 애니메이션
  - 도구 실행 상태 표시
  - 대화 이력 저장 및 검색 기능
  - 사용자 피드백 수집 UI

### 4.2 백엔드

- **서버 기술**
  - Node.js 또는 Spring Boot 기반 백엔드
  - RESTful API 설계
  - 실시간 데이터 처리 지원
  - 웹소켓을 통한 실시간 통신

- **LLM 연동 모듈**
  - LLM API 연동 (Claude, GPT 등)
  - 프롬프트 관리 및 최적화
  - 도구 정의 및 스키마 관리
  - 컨텍스트 관리 및 토큰 최적화
  - LLM 모델 호스팅 및 관리 (Claude 3.7 Sonnet 등)

- **도구 실행 엔진**
  - 웹 자동화를 위한 스크립팅 엔진
  - 도구 호출 및 파라미터 처리
  - 도구 실행 결과 처리 및 피드백
  - 오류 처리 및 복구 메커니즘
  - 사용자 행동 학습 및 패턴 인식 기능

### 4.3 보안

- 사용자 인증 및 권한 관리
- 민감 정보 암호화
- API 호출 보안
- 자동화 작업의 안전장치 구현
- 도구 호출 권한 제어
- LLM 프롬프트 인젝션 방지

## 5. 성능 요구사항

- 프롬프트 처리 응답 시간: 2초 이내
- 자동화 작업 실행 시간: 수동 작업 대비 50% 이상 단축
- 동시 사용자 100명 이상 지원
- 브라우저 메모리 사용량 최적화
- LLM 모델 토큰 사용량 최적화 (maxTokens: 8192 이내)
- 도구 호출 성공률: 95% 이상
- 사용자 의도 파악 정확도: 90% 이상

## 6. 구현 우선순위

1. AI 어시스턴트 사이드바 기본 구조 구현
2. System Prompt 및 도구 스키마 정의
3. LLM 연동 및 기본 의도 분석 기능
4. 기본 웹 인터페이스 도구 구현 (navigate_to, click_element, input_text)
5. 프롬프트 기반 메뉴 이동 자동화
6. 템플릿 검색 및 선택 자동화
7. 문자 발송 프로세스 자동화
8. 데이터 처리 및 분석 자동화
9. 고급 AI 모델 연동 및 학습 기능
10. 추가 도구 및 기능 확장

## 7. 제약사항 및 가정

- 기존 메시지허브 시스템의 API 및 구조 활용
- 모던 브라우저(Chrome, Firefox, Safari, Edge 최신 버전) 지원
- 사용자 네트워크 환경에 따른 성능 차이 발생 가능
- 초기 AI 모델은 제한된 기능만 지원하며 점진적으로 확장
- LLM 모델 호출 비용 고려 (토큰 사용량 최적화)
- 웹사이트 구조 변경 시 도구 정의 업데이트 필요
- 사용자 승인이 필요한 중요 작업 식별 및 관리

## 8. 향후 확장 계획

- 음성 인식을 통한 프롬프트 입력 지원
- 사용자별 맞춤형 자동화 시나리오 저장 및 실행
- 발송 패턴 분석을 통한 최적 발송 시간 추천
- 다국어 지원 확대
- 모바일 앱 연동
- 추가 도구 및 기능 확장 (이미지 생성, 코드 분석 등)
- 사용자 행동 패턴 학습을 통한 자동화 추천 기능
- 타 시스템과의 통합 및 API 연동 확장 